# Node.js NoSQL (Firebase Firestore) - MVC Architecture

A Node.js application using Firebase Firestore (NoSQL) with an MVC (Model-View-Controller) architecture pattern, similar to the node-advanced project structure but using NoSQL instead of MySQL.

## Project Structure

```
nodejs-nosql/
├── app/
│   ├── Controllers/
│   │   ├── Api/
│   │   │   └── ApiBooksController.ts    # API endpoints for JSON responses
│   │   └── Web/
│   │       └── BooksController.ts        # Web routes for HTML views
│   ├── DB/
│   │   └── db-connection.ts              # Firebase Firestore connection singleton
│   └── Models/
│       └── Books.ts                      # Books model with CRUD operations
├── public/                               # Static files (CSS, JS, images)
├── types/
│   └── session.d.ts                      # TypeScript session type definitions
├── views/                                # Nunjucks templates
│   ├── index.njk                         # List all books
│   ├── add.njk                          # Add new book form
│   ├── edit.njk                         # Edit book form
│   └── book-detail.njk                  # Single book detail view
├── firebase.json                         # Firebase service account credentials
├── index.ts                              # Main application entry point
├── package.json                          # Dependencies and scripts
└── tsconfig.json                         # TypeScript configuration
```

## Features

- **MVC Architecture**: Clean separation of concerns with Models, Views, and Controllers
- **Firebase Firestore**: NoSQL database for flexible data storage
- **TypeScript**: Type-safe development
- **Express.js**: Web application framework
- **Nunjucks**: Template engine for dynamic HTML (similar to Jinja2)
- **Session Management**: Flash messages for user feedback
- **RESTful API**: JSON endpoints for API consumers
- **Web Interface**: HTML views for browser interaction

## Prerequisites

- Node.js (v22.x or higher)
- npm (v10.x or higher)
- Firebase project with Firestore enabled
- Firebase service account credentials

## Installation

1. Clone the repository:
```bash
cd /Users/elvis_1/Sites/telecadnode/nodejs-nosql
```

2. Install dependencies:
```bash
npm install
```

3. Configure Firebase:
   - Ensure `firebase.json` contains your Firebase service account credentials
   - This file should already be present in the project root

4. Start the development server:
```bash
npm run dev:watch
```

The server will start at `http://localhost:3000`

## Available Scripts

- `npm run dev` - Run the app with ts-node
- `npm run dev:watch` - Run with nodemon for auto-restart on file changes
- `npm run build` - Compile TypeScript to JavaScript
- `npm start` - Run the compiled JavaScript (after build)

## API Endpoints

### JSON API Routes (for API consumers)

- `GET /api/books` - Get all books
- `GET /api/books/:id` - Get single book by ID
- `POST /api/books/save` - Create new book
- `POST /api/books/:id` - Update book by ID
- `DELETE /api/books/:id` - Delete book by ID

### Web Routes (HTML views)

- `GET /` or `GET /books` - View all books
- `GET /books/add` - Show add book form
- `GET /books/:id` - View single book details
- `GET /books/:id/edit` - Show edit book form
- `POST /books/save-book` - Save new book (form submission)
- `POST /books/:id` - Update book (form submission)
- `DELETE /books/:id` - Delete book (AJAX)

## Database Structure

### Books Collection

Each book document in Firestore contains:
```typescript
{
  title: string,        // Book title
  author_name: string,  // Author name
  year: string,         // Publication year
  price?: string        // Optional price
}
```

The document ID is automatically generated by Firestore and used as the book ID.

## Key Components

### Database Connection (`app/DB/db-connection.ts`)
- Singleton pattern for Firebase Firestore connection
- Initializes Firebase Admin SDK
- Provides centralized database access

### Books Model (`app/Models/Books.ts`)
- CRUD operations for books
- Methods: `getBooks()`, `getBookById()`, `createBook()`, `updateBook()`, `deleteBook()`

### Controllers
- **BooksController** (`app/Controllers/Web/`): Handles web routes with HTML responses and flash messages
- **ApiBooksController** (`app/Controllers/Api/`): Handles API routes with JSON responses

## Features Implemented

✅ Complete CRUD operations (Create, Read, Update, Delete)
✅ Flash messages for user feedback (success/error)
✅ Form validation
✅ AJAX delete functionality
✅ RESTful API endpoints
✅ Responsive Bootstrap UI
✅ TypeScript type safety
✅ MVC architecture pattern
✅ Session management

### Key Differences:

## Troubleshooting

const port = process.env.PORT || 4000; // Change to available port
```

### Firebase Connection Issues
- Verify `firebase.json` exists and contains valid credentials
- Ensure Firestore is enabled in your Firebase project
- Check Firebase project ID matches in credentials

### TypeScript Errors
Run the TypeScript compiler to check for errors:
```bash
npx tsc --noEmit




cd nodejs-nosql

npm i

//go to google console and generate firestore file